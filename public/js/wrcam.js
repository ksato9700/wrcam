// Generated by CoffeeScript 1.3.1
(function() {
  var WRCam;

  WRCam = (function() {

    WRCam.name = 'WRCam';

    function WRCam(local_video, remote_video, canvas, onended, onstart) {
      var _this = this;
      this.local_video = local_video;
      this.remote_video = remote_video;
      this.canvas = canvas;
      navigator.webkitGetUserMedia("video,audio", function(stream) {
        _this.local_video.src = webkitURL.createObjectURL(stream);
        _this.local_video.onerror = function() {
          return stream.stop();
        };
        stream.onended = onended;
        _this.stream = stream;
        _this.local = new webkitDeprecatedPeerConnection("STUN stun.l.google.com:19302", function(message) {
          return /(?:)/;
        });
        _this.local.addStream(_this.stream);
        _this.local.onaddstream = function(event) {
          return this.remote_video.src = webkitURL.createObjectURL(event.stream);
        };
        return console.log(_this.local);
      }, onended);
      onstart();
    }

    WRCam.prototype.snapshot = function() {
      this.canvas.width = this.local_video.videoWidth;
      this.canvas.height = this.local_video.videoHeight;
      return this.canvas.getContext('2d').drawImage(this.local_video, 0, 0);
    };

    return WRCam;

  })();

  window.WRCam = WRCam;

}).call(this);
